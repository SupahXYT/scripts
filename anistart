#!/bin/sh

help="usage:  anistart <operation>
operations:
    anistart {-s --start}
    anistart {-S --stop}
    anistart {-h --help}"

start()
{
	RCLONE_CONFIG_PASS="$(pass rclone/config)"
	export RCLONE_CONFIG_PASS

	echo "Mounting rclone"
	ping -qc1 8.8.8.8 > /dev/null 2>&1 \
		&& rclone mount --ask-password=false --daemon --allow-other jousd-drive: /media/drive/jousd-drive-root \
		&& rclone mount --ask-password=false --daemon --allow-other jousd-drive-timing: /media/drive/jousd-drive-timing \
		&& rclone mount --ask-password=false --daemon --allow-other jousd-drive-subeki: /media/drive/jousd-drive-subeki \
		&& rclone mount --ask-password=false --daemon --allow-other jousd-drive-neocrypt: /media/drive/jousd-drive-neocrypt \
		|| echo "Error: no internet" 
}

stop()
{
	echo "Unmounting rclone"
	[ -n "$(pgrep rclone)" ] \
		; sudo fusermount -zu /media/drive/jousd-drive-root \
		; sudo fusermount -zu /media/drive/jousd-drive-timing\
		; sudo fusermount -zu /media/drive/jousd-drive-subeki \
		; sudo fusermount -zu /media/drive/jousd-drive-neocrypt 
}

case $1 in 
-s | --start)
	start
	;;
-S | --stop)
	stop
	;;
-h | --help)
	printf "%s\n" "$help"
	;;
*)
	printf "anistart: invalid option -- '%s'\n" "$1"
	;;
esac


